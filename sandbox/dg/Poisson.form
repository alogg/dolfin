# Copyright (C) 2006-2007 Kristiand Oelgaard and Anders Logg.
# Licensed under the GNU LGPL Version 2.1.
#
# First added:  2006-12-05
# Last changed: 2007-05-09
#
# The bilinear form a(v, u) and linear form L(v) for
# Poisson's equation in a discontinuous Galerkin (DG)
# formulation.
#
# Compile this form with FFC: ffc -l dolfin Poisson.form

# Elements
#DG1 = FiniteElement("Discontinuous Lagrange", "triangle", 1)
#DGn = VectorElement("Discontinuous Lagrange", "triangle", 0)
#DGh = FiniteElement("Discontinuous Lagrange", "triangle", 0)

DG1 = FiniteElement("Discontinuous Lagrange", "tetrahedron", 1)
DGn = VectorElement("Discontinuous Lagrange", "tetrahedron", 0)
DGh = FiniteElement("Discontinuous Lagrange", "tetrahedron", 0)

# Test and trial functions
v = TestFunction(DG1)
u = TrialFunction(DG1)

#n = Function(DGn)
h = MeshSize("tetrahedron")

#def inv(h):
#    return 2/(h('+') + h('-'))

#a = dot(jump(v,n), avg(grad(u)))*dS
#a = inv(h)*v('+')*u('-')*dS

#a = avg(h)*v('+')*u('-')*dS
#a = h('+')*v('+')*u('-')*dS
#a = v*u*h*ds
a = 1.0/h('+')*v('+')*u('-')*dS
#a = avg(1.0/h)*v('+')*u('-')*dS


#a = h*v*u*ds












